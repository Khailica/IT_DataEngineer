Для main.ddl

1. Создаём таблицы измерений в приёмнике в SCD2:

1.1 Из базы данных
de11tm.ykir_dwh_dim_accounts_hist
de11tm.ykir_dwh_dim_cards_hist
de11tm.ykir_dwh_dim_clients_hist

1.1 из excel-файлов
de11tm.ykir_dwh_dim_terminals_hist


2. Таблицы фактов в приёмнике:

2.1 из excel-файлов
de11tm.ykir_dwh_fact_passport_blacklist_hist

2.2 из csv-файлов
de11tm.ykir_dwh_fact_transactions_hist


3. Cтейджинговые таблицы:
de11tm.ykir_stg_dim_accounts
de11tm.ykir_stg_dim_cards
de11tm.ykir_stg_dim_clients

de11tm.ykir_stg_dim_terminals

de11tm.ykir_stg_fact_passport_blacklist
de11tm.ykir_stg_fact_transactions

4. Таблицы метаданных:
de11tm.ykir_meta_dim_accounts
de11tm.ykir_meta_dim_cards
de11tm.ykir_meta_dim_clients

de11tm.ykir_meta_dim_terminals

de11tm.ykir_meta_fact_passport_blacklist
de11tm.ykir_meta_fact_transactions

de11tm.ykir_stg_delete_dim_accounts
de11tm.ykir_stg_delete_dim_cards
de11tm.ykir_stg_delete_dim_clients

de11tm.ykir_stg_delete_dim_terminals

de11tm.ykir_stg_delete_fact_passport_blacklist
de11tm.ykir_stg_delete_fact_transactions

5. Таблица отчёта:
de11tm.ykir_rep_fraud


Для initial_load.py

1. Загрузить библиотеки, подключится к БД, очистить стейджинговые таблицы
2. Захват данных из источника в STG, начальная загрузка в хранилище DWH






